"use strict";(self.webpackChunkerlendthune_com=self.webpackChunkerlendthune_com||[]).push([[4573],{8435:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>d,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"treasurehunter/create-treasure-hunt","title":"Create Treasure Hunt","description":"","source":"@site/docs/treasurehunter/create-treasure-hunt.mdx","sourceDirName":"treasurehunter","slug":"/treasurehunter/create-treasure-hunt","permalink":"/docs/treasurehunter/create-treasure-hunt","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Create Treasure Hunt","hide_title":true},"sidebar":"productsSidebar","previous":{"title":"Instructions","permalink":"/docs/treasurehunter/instructions"},"next":{"title":"Treasure Hunt","permalink":"/docs/treasurehunter/treasure-hunt"}}');var a=n(4848),o=n(8453),s=n(6540);function i(e){return new Promise(((t,n)=>{if(window.initSqlJs)return void t();const r=document.createElement("script");r.src=e,r.async=!0,r.onload=t,r.onerror=n,document.body.appendChild(r)}))}const l=()=>{const[e,t]=(0,s.useState)(null),[n,r]=(0,s.useState)("Vent, laster inn..."),[o,l]=(0,s.useState)(""),[d,c]=(0,s.useState)(null),[u,h]=(0,s.useState)([]),g=e=>{const t=e.export(),n=function(e){let t,n=0,r=e.length,a="";for(;n<r;)t=e.subarray(n,Math.min(n+32768,r)),a+=String.fromCharCode.apply(null,t),n+=32768;return btoa(a)}(new Uint8Array(t));localStorage.setItem("sqlite-db",n),console.log("Database saved to localStorage")},p=e=>{const t=e.exec("SELECT * FROM steg"),n=t[0]?t[0].values:[];h(n)};(0,s.useEffect)((()=>{(async()=>{const e={locateFile:()=>"/sql/sql-wasm.wasm"};try{await i("/sql/sql-wasm.js");const n=await window.initSqlJs(e);let a;console.log("sql.js initialized \ud83c\udf89");const o=localStorage.getItem("sqlite-db");if(o){const e=new Uint8Array(atob(o).split("").map((e=>e.charCodeAt(0))));a=new n.Database(e),console.log("Database loaded from localStorage")}else a=new n.Database,a.run("\n          CREATE TABLE IF NOT EXISTS steg (\n            qrkode TEXT PRIMARY KEY,\n            bilde_base64 TEXT\n          );\n        ");t(a),r("Start adding QR codes and images!"),p(a)}catch(n){console.error("Error initializing sql.js:",n),r("Could not load the database.")}})()}),[]);return(0,a.jsxs)("div",{style:{maxWidth:500,margin:"40px auto",padding:24,background:"var(--ifm-background-color)",color:"var(--ifm-font-color-base)",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.08)"},children:[(0,a.jsx)("h1",{style:{textAlign:"center"},children:"Add QR number and image"}),(0,a.jsx)("p",{children:n}),(0,a.jsx)("div",{style:{marginBottom:16},children:(0,a.jsxs)("label",{style:{display:"block",fontWeight:500,marginBottom:6},children:["QR-code number:",(0,a.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"1, 2, 3...",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"1rem",marginTop:4,marginBottom:8,boxSizing:"border-box",outline:"none",transition:"border 0.2s"}})]})}),(0,a.jsx)("div",{style:{marginBottom:16},children:(0,a.jsxs)("label",{style:{display:"block",fontWeight:500,marginBottom:6},children:["Upload image:",(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onloadend=()=>{const e=new Image;e.onload=()=>{const t=460;let{width:n,height:r}=e;n>r?n>t&&(r*=t/n,n=t):r>t&&(n*=t/r,r=t);const a=document.createElement("canvas");a.width=n,a.height=r;a.getContext("2d").drawImage(e,0,0,n,r);const o=a.toDataURL("image/jpeg",.7);c(o)},e.src=n.result},n.readAsDataURL(t)},style:{display:"none"},id:"file-upload-input"}),(0,a.jsx)("label",{htmlFor:"file-upload-input",style:{display:"inline-block",padding:"10px 20px",borderRadius:6,border:"none",background:"#1976d2",color:"#fff",fontWeight:600,fontSize:"1rem",cursor:"pointer",marginTop:4,boxShadow:"0 1px 4px rgba(25, 118, 210, 0.08)",transition:"background 0.2s"},children:"Choose file"})]})}),d&&(0,a.jsxs)("div",{style:{marginBottom:16},children:[(0,a.jsx)("h3",{style:{marginBottom:8},children:"Preview of image:"}),(0,a.jsx)("img",{src:d,alt:"Preview",width:"100",style:{borderRadius:8,boxShadow:"0 1px 6px rgba(0,0,0,0.08)"}})]}),(0,a.jsx)("div",{style:{marginBottom:24},children:(0,a.jsx)("button",{onClick:()=>{if(!o||!d||!e)return void r("Fyll ut alle feltene!");const t=e.prepare("SELECT COUNT(*) as count FROM steg WHERE qrkode = ?");t.bind([o]);let n=!1;if(t.step()){n=t.getAsObject().count>0}t.free(),n?(e.run("UPDATE steg SET bilde_base64 = ? WHERE qrkode = ?",[d,o]),r(`QR-kode ${o} oppdatert med nytt bilde!`)):(e.run("INSERT INTO steg (qrkode, bilde_base64) VALUES (?, ?)",[o,d]),r(`QR-kode ${o} og bilde lagret!`)),g(e),p(e),l(""),c(null)},style:{padding:"10px 20px",borderRadius:6,border:"none",background:"#1976d2",color:"#fff",fontWeight:600,fontSize:"1rem",cursor:"pointer",marginRight:12,boxShadow:"0 1px 4px rgba(25, 118, 210, 0.08)",transition:"background 0.2s"},children:"Save QR-code and image"})}),(0,a.jsx)("h2",{children:"Image database:"}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"QR-code"}),(0,a.jsx)("th",{children:"Image (Base64)"})]})}),(0,a.jsx)("tbody",{children:0===u.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"2",children:"The database is empty"})}):u.map(((e,t)=>{let[n,r]=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:n}),(0,a.jsx)("td",{children:(0,a.jsx)("img",{src:r,alt:`Bilde ${n}`,width:"50"})})]},t)}))})]}),(0,a.jsx)("div",{style:{margin:"24px 0"},children:(0,a.jsx)("button",{onClick:async()=>{localStorage.removeItem("sqlite-db"),r("Databasen er t\xf8mt.");await i("/sql/sql-wasm.js");const e=new((await window.initSqlJs({locateFile:()=>"/sql/sql-wasm.wasm"})).Database);e.run("CREATE TABLE IF NOT EXISTS steg (qrkode TEXT PRIMARY KEY, bilde_base64 TEXT);"),t(e),h([]),l(""),c(null)},style:{padding:"10px 20px",borderRadius:6,border:"none",background:"#e74c3c",color:"#fff",fontWeight:600,fontSize:"1rem",cursor:"pointer",boxShadow:"0 1px 4px rgba(231, 76, 60, 0.08)",transition:"background 0.2s"},children:"Clear database"})})]})},d={sidebar_position:2,title:"Create Treasure Hunt",hide_title:!0},c=void 0,u={},h=[];function g(e){return(0,a.jsx)(l,{})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(g,{...e})}):g()}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>i});var r=n(6540);const a={},o=r.createContext(a);function s(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);