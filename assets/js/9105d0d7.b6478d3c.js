"use strict";(self.webpackChunkerlendthune_com=self.webpackChunkerlendthune_com||[]).push([[7975],{2169:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(6540),s=n(6624),a=n.n(s),i=n(4848);const c=()=>{const e=(0,r.useRef)(null),t=(0,r.useRef)(null),[n,s]=(0,r.useState)(""),[c,d]=(0,r.useState)(null),[l,o]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{var e;await(e="/garmin/sql-wasm.js",new Promise(((t,n)=>{if(window.initSqlJs)return void t();const r=document.createElement("script");r.src=e,r.async=!0,r.onload=t,r.onerror=n,document.body.appendChild(r)})));const t=await window.initSqlJs({locateFile:()=>"/garmin/sql-wasm.wasm"}),n=localStorage.getItem("sqlite-db");let r;if(n){const e=new Uint8Array(atob(n).split("").map((e=>e.charCodeAt(0))));r=new t.Database(e)}else r=new t.Database,r.run("CREATE TABLE IF NOT EXISTS steg (qrkode TEXT PRIMARY KEY, bilde_base64 TEXT);");o(r)})()}),[]),(0,r.useEffect)((()=>{let n,r=null;return(async()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const i=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});r=i,e.current&&(e.current.srcObject=i,e.current.setAttribute("playsinline",!0),e.current.play());const c=()=>{if(e.current&&t.current){const n=t.current.getContext("2d");n.drawImage(e.current,0,0,t.current.width,t.current.height);const r=n.getImageData(0,0,t.current.width,t.current.height),i=a()(r.data,r.width,r.height);i&&i.data&&s(i.data)}n=requestAnimationFrame(c)};c()}})(),()=>{if(n&&cancelAnimationFrame(n),e.current&&e.current.srcObject){e.current.srcObject.getTracks().forEach((e=>e.stop())),e.current.srcObject=null}r&&r.getTracks().forEach((e=>e.stop()))}}),[]),(0,r.useEffect)((()=>{if(l&&n)try{const e=l.prepare("SELECT bilde_base64 FROM steg WHERE qrkode = ?");if(e.bind([n]),e.step()){const t=e.getAsObject();d(t.bilde_base64)}else d(null);e.free()}catch(e){d(null)}}),[l,n]),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"QR-code scanner"}),(0,i.jsx)("video",{ref:e,style:{width:320,height:240}}),(0,i.jsx)("canvas",{ref:t,width:320,height:240,style:{display:"none"}}),(0,i.jsxs)("div",{children:["Scanned code: ",n]}),c?(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{children:["Image for code ",n,":"]}),(0,i.jsx)("img",{src:c,alt:`Bilde for kode ${n}`,style:{maxWidth:"100%"}})]}):n?(0,i.jsxs)("div",{children:["Could not find image for code ",n,"."]}):null]})};function d(){return(0,i.jsxs)("div",{style:{maxWidth:500,margin:"40px auto",padding:24,background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.08)"},children:[(0,i.jsx)("h1",{style:{textAlign:"center"},children:"Treasure Hunt"}),(0,i.jsx)(c,{})]})}}}]);